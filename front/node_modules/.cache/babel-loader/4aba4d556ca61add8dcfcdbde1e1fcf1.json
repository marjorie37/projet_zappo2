{"ast":null,"code":"import _classCallCheck from \"/home/findev/Documents/lyon-0218-js-zappo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/findev/Documents/lyon-0218-js-zappo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/findev/Documents/lyon-0218-js-zappo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/findev/Documents/lyon-0218-js-zappo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/findev/Documents/lyon-0218-js-zappo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/home/findev/Documents/lyon-0218-js-zappo/front/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/home/findev/Documents/lyon-0218-js-zappo/front/src/components/ZappoOrdersTablette/OrdersMain.js\";\nimport React, { Component } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport OrderNavSlider from \"./OrderNavSlider\";\nimport OrderDetails from \"./OrderDetails\";\nimport OrderNavButton from \"./OrderNavButton\";\nimport RootContainer from \"../../styled/RootContainer\";\nimport { StyledMainColumn } from \"../../styled/StyledOrdersNav\";\nimport axios from \"axios\";\nimport config from \"../../assets/lib/axiosStaff\";\nimport io from \"socket.io-client\";\nvar socket = io(\"http://localhost:5000\");\n\nvar OrdersMain =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(OrdersMain, _Component);\n\n  function OrdersMain(props) {\n    var _this;\n\n    _classCallCheck(this, OrdersMain);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(OrdersMain).call(this, props));\n    _this.state = {\n      pending: [],\n      accepted: [],\n      finished: [],\n      canceled: [],\n      status: [\"attente\", \"valider\", \"terminer\", \"annuler\"]\n    };\n    _this.handleClickChangeCard = _this.handleClickChangeCard.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.filterByStatus = _this.filterByStatus.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleChangeCategory = _this.handleChangeCategory.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(OrdersMain, [{\n    key: \"filterByStatus\",\n    value: function filterByStatus(orders) {\n      var status = [\"pending\", \"accepted\", \"finished\", \"canceled\"];\n      return status.reduce(function (ac, el, i, tab) {\n        ac[status[i]] = orders.filter(function (el) {\n          return Number(el.state) === i;\n        });\n        return ac;\n      }, {});\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (this.props.user === null) this.props.history.push('/zappo/connexion');\n      axios(config({}, \"/\", \"get\")).then(function (res) {\n        _this2.setState(_this2.filterByStatus(res.data));\n      });\n      socket.on(\"created\", function (orders) {\n        return _this2.setState(_this2.filterByStatus(orders));\n      });\n      socket.on(\"updated\", function (orders) {\n        return _this2.setState(_this2.filterByStatus(orders));\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var prevActivateListItem = prevState.activateListItem;\n      var activateListItem = this.state.activateListItem;\n      var activateList = this.state[activateListItem];\n      var prevActivateList = prevActivateListItem ? prevState[prevActivateListItem] : null;\n\n      if (prevActivateList !== null && activateList !== null) {\n        if (activateList.length !== prevActivateList.length) {\n          this.setState({\n            activateOrder: activateList[0]\n          });\n        }\n      }\n    }\n  }, {\n    key: \"handleClickChangeCard\",\n    value: function handleClickChangeCard(activateOrder) {\n      this.setState({\n        activateOrder: activateOrder\n      });\n    }\n  }, {\n    key: \"handleChangeCategory\",\n    value: function handleChangeCategory(status) {\n      this.setState({\n        activateListItem: status\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          pending = _this$state.pending,\n          status = _this$state.status,\n          activateListItem = _this$state.activateListItem,\n          activateOrder = _this$state.activateOrder;\n      return React.createElement(RootContainer, {\n        img: true,\n        overflowY: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73\n        },\n        __self: this\n      }, React.createElement(OrderNavButton, {\n        pending: pending.length > 0 ? true : false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74\n        },\n        __self: this\n      }), React.createElement(Grid, {\n        container: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75\n        },\n        __self: this\n      }, React.createElement(OrderNavSlider, Object.assign({\n        handleChangeCategory: this.handleChangeCategory,\n        handleClickChangeCard: this.handleClickChangeCard\n      }, this.state, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76\n        },\n        __self: this\n      })), React.createElement(StyledMainColumn, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, React.createElement(OrderDetails, {\n        listItem: activateListItem,\n        orderTab: activateListItem ? this.state[activateListItem] : [],\n        order: activateOrder ? activateOrder : null,\n        status: status,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }))));\n    }\n  }]);\n\n  return OrdersMain;\n}(Component);\n\nexport default OrdersMain;","map":{"version":3,"sources":["/home/findev/Documents/lyon-0218-js-zappo/front/src/components/ZappoOrdersTablette/OrdersMain.js"],"names":["React","Component","Grid","OrderNavSlider","OrderDetails","OrderNavButton","RootContainer","StyledMainColumn","axios","config","io","socket","OrdersMain","props","state","pending","accepted","finished","canceled","status","handleClickChangeCard","bind","filterByStatus","handleChangeCategory","orders","reduce","ac","el","i","tab","filter","Number","user","history","push","then","res","setState","data","on","prevProps","prevState","prevActivateListItem","activateListItem","activateList","prevActivateList","length","activateOrder"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { Grid } from \"@material-ui/core\";\nimport OrderNavSlider from \"./OrderNavSlider\";\nimport OrderDetails from \"./OrderDetails\";\nimport OrderNavButton from \"./OrderNavButton\";\nimport RootContainer from \"../../styled/RootContainer\";\nimport { StyledMainColumn } from \"../../styled/StyledOrdersNav\";\nimport axios from \"axios\";\nimport config from \"../../assets/lib/axiosStaff\";\nimport io from \"socket.io-client\";\n\n\nconst socket = io(\"http://localhost:5000\");\n\n\n\nclass OrdersMain extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pending:[],\n      accepted:[],\n      finished:[],\n      canceled:[],\n      status: [\"attente\", \"valider\", \"terminer\", \"annuler\"]\n    };\n    this.handleClickChangeCard = this.handleClickChangeCard.bind(this);\n    this.filterByStatus = this.filterByStatus.bind(this);\n    this.handleChangeCategory = this.handleChangeCategory.bind(this);\n  }\n\n  filterByStatus(orders) {\n    const status = [\"pending\", \"accepted\", \"finished\", \"canceled\"]\n    return status.reduce((ac,el,i,tab)=>\n     {ac[status[i]]=orders.filter(el => Number(el.state) === i);return ac},{})\n  }\n\n  componentDidMount() {\n    if (this.props.user === null) this.props.history.push('/zappo/connexion');\n    axios(config({},\"/\",\"get\")).then(res => {\n      this.setState(this.filterByStatus(res.data));\n    });\n    socket.on(\"created\", orders => this.setState(this.filterByStatus(orders)));\n    socket.on(\"updated\", orders => this.setState(this.filterByStatus(orders)));\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const {activateListItem:prevActivateListItem} = prevState;\n    const { activateListItem } = this.state;\n    const activateList = this.state[activateListItem];\n    const prevActivateList = prevActivateListItem ? prevState[prevActivateListItem] : null;\n\n    if (prevActivateList !== null && activateList !== null) {\n      if (activateList.length !== prevActivateList.length) {\n        this.setState({ activateOrder: activateList[0] })\n      }\n    }\n  }\n\n\n  handleClickChangeCard(activateOrder) {\n    this.setState({ activateOrder });\n  }\n\n  handleChangeCategory(status){\n    this.setState({activateListItem:status})\n  }\n\n  render() {\n    const {pending,status, activateListItem, activateOrder} = this.state;\n\n    return (\n      <RootContainer img overflowY>\n        <OrderNavButton pending={pending.length > 0 ? true : false} />\n        <Grid container>\n          <OrderNavSlider\n            handleChangeCategory={this.handleChangeCategory}\n            handleClickChangeCard={this.handleClickChangeCard}\n            {...this.state}\n          />\n          <StyledMainColumn>\n            <OrderDetails\n              listItem={activateListItem}\n              orderTab={activateListItem ? this.state[activateListItem] : []}\n              order={activateOrder ? activateOrder : null}\n              status={status}\n            />\n          </StyledMainColumn>\n        </Grid>\n      </RootContainer>\n    );\n  }\n}\n\nexport default OrdersMain;\n"]},"metadata":{},"sourceType":"module"}