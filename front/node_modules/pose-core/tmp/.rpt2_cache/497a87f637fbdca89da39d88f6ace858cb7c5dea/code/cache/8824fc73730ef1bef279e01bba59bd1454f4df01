{"code":"import * as tslib_1 from \"tslib\";\r\nimport createPoseSetter from './factories/setter';\r\nimport createValueMap from './factories/values';\r\nimport generateDefaultTransitions from './factories/transitions';\r\nimport { eachValue, fromPose } from './inc/transition-composers';\r\nimport { selectPoses, selectAllValues } from './inc/selectors';\r\nvar poseFactory = function (_a) {\r\n    var getDefaultProps = _a.getDefaultProps, defaultTransitions = _a.defaultTransitions, bindOnChange = _a.bindOnChange, startAction = _a.startAction, stopAction = _a.stopAction, readValue = _a.readValue, readValueFromSource = _a.readValueFromSource, resolveTarget = _a.resolveTarget, createValue = _a.createValue, convertValue = _a.convertValue, getInstantTransition = _a.getInstantTransition, getTransitionProps = _a.getTransitionProps, addActionDelay = _a.addActionDelay, selectValueToRead = _a.selectValueToRead, convertTransitionDefinition = _a.convertTransitionDefinition, transformPose = _a.transformPose, extendAPI = _a.extendAPI;\r\n    return function (config) {\r\n        var parentValues = config.parentValues, _a = config.ancestorValues, ancestorValues = _a === void 0 ? [] : _a;\r\n        if (parentValues)\r\n            ancestorValues.unshift({ values: parentValues });\r\n        var activeActions = new Map();\r\n        var activePoses = new Map();\r\n        var children = new Set();\r\n        var poses = generateDefaultTransitions(selectPoses(config), defaultTransitions);\r\n        var props = config.props || {};\r\n        if (getDefaultProps)\r\n            props = tslib_1.__assign({}, props, getDefaultProps(config));\r\n        var passive = config.passive, userSetValues = config.values, initialPose = config.initialPose;\r\n        var values = createValueMap({\r\n            poses: poses,\r\n            passive: passive,\r\n            ancestorValues: ancestorValues,\r\n            readValue: readValue,\r\n            createValue: createValue,\r\n            convertValue: convertValue,\r\n            readValueFromSource: readValueFromSource,\r\n            userSetValues: userSetValues,\r\n            initialPose: initialPose,\r\n            props: props\r\n        });\r\n        var state = {\r\n            activeActions: activeActions,\r\n            activePoses: activePoses,\r\n            children: children,\r\n            props: props,\r\n            values: values\r\n        };\r\n        var onChange = config.onChange;\r\n        if (onChange)\r\n            Object.keys(onChange).forEach(bindOnChange(values, onChange));\r\n        var set = createPoseSetter({\r\n            state: state,\r\n            poses: poses,\r\n            getInstantTransition: getInstantTransition,\r\n            getTransitionProps: getTransitionProps,\r\n            convertTransitionDefinition: convertTransitionDefinition,\r\n            startAction: startAction,\r\n            stopAction: stopAction,\r\n            resolveTarget: resolveTarget,\r\n            addActionDelay: addActionDelay,\r\n            transformPose: transformPose\r\n        });\r\n        var api = {\r\n            set: set,\r\n            get: function (valueName) {\r\n                return valueName\r\n                    ? selectValueToRead(values.get(valueName))\r\n                    : selectAllValues(values, selectValueToRead);\r\n            },\r\n            has: function (poseName) { return !!poses[poseName]; },\r\n            setProps: function (newProps) { return (props = tslib_1.__assign({}, props, newProps)); },\r\n            _addChild: function (childConfig, factory) {\r\n                var child = factory(tslib_1.__assign({ initialPose: initialPose }, childConfig, { ancestorValues: [{ label: config.label, values: values }].concat(ancestorValues) }));\r\n                children.add(child);\r\n                return child;\r\n            },\r\n            removeChild: function (child) { return children.delete(child); },\r\n            clearChildren: function () {\r\n                children.forEach(function (child) { return child.destroy(); });\r\n                children.clear();\r\n            },\r\n            destroy: function () {\r\n                activeActions.forEach(stopAction);\r\n                children.forEach(function (child) { return child.destroy(); });\r\n            }\r\n        };\r\n        return extendAPI(api, state, config);\r\n    };\r\n};\r\nexport default poseFactory;\r\nexport { eachValue, fromPose };\r\n//# sourceMappingURL=index.js.map","map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"src/index.ts\"],\"names\":[],\"mappings\":\"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\"}"}
